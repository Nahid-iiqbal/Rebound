#include<stdio.h>
#include<time.h>
#include<windows.h>

FILE *fileptr, *fr;

int levelGrid[5][15][15] = {
    {
        {5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1},
        {2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5},
        {1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2},
        {5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1},
        {2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5},
        {1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2},
        {5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1},
        {2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5},
        {1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2},
        {5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1, 5, 2, 1},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    },
    {
        {5, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 5},
        {0, 5, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 5, 0},
        {0, 0, 5, 0, 0, 1, 1, 2, 1, 1, 0, 0, 5, 0, 0},
        {0, 0, 0, 5, 1, 1, 2, 2, 2, 1, 1, 5, 0, 0, 0},
        {0, 0, 0, 1, 1, 2, 2, 3, 2, 2, 1, 1, 0, 0, 0},
        {0, 0, 1, 1, 2, 2, 3, 3, 3, 2, 2, 1, 1, 0, 0},
        {0, 1, 1, 2, 2, 3, 3, 4, 3, 3, 2, 2, 1, 1, 0},
        {1, 1, 2, 2, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 1},
        {0, 1, 1, 2, 2, 3, 3, 4, 3, 3, 2, 2, 1, 1, 0},
        {0, 0, 1, 1, 2, 2, 3, 3, 3, 2, 2, 1, 1, 0, 0},
        {0, 0, 0, 1, 1, 2, 2, 3, 2, 2, 1, 1, 0, 0, 0},
        {0, 0, 0, 5, 1, 1, 2, 2, 2, 1, 1, 5, 0, 0, 0},
        {0, 0, 5, 0, 0, 1, 1, 2, 1, 1, 0, 0, 5, 0, 0},
        {0, 5, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 5, 0},
        {5, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 5},
    },
    {
        {1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2},
        {1, 5, 1, 2, 5, 2, 3, 5, 3, 1, 5, 1, 2, 5, 2},
        {1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2},
        {2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3},
        {2, 5, 2, 3, 5, 3, 1, 5, 1, 2, 5, 2, 3, 5, 3},
        {2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3},
        {3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1},
        {3, 5, 3, 1, 5, 1, 2, 5, 2, 3, 5, 3, 1, 5, 1},
        {3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1},
        {1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2},
        {1, 5, 1, 2, 5, 2, 3, 5, 3, 1, 5, 1, 2, 5, 2},
        {1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2},
        {2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3},
        {2, 5, 2, 3, 5, 3, 1, 5, 1, 2, 5, 2, 3, 5, 3},
        {2, 2, 2, 3, 3, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3},
    },
    {
        {1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3},
        {4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4},
        {3, 0, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 0, 3},
        {2, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 2},
        {1, 0, 3, 0, 1, 2, 3, 4, 1, 2, 3, 0, 3, 0, 1},
        {2, 0, 2, 0, 4, 0, 0, 0, 0, 0, 4, 0, 2, 0, 2},
        {3, 0, 1, 0, 3, 0, 1, 2, 3, 0, 3, 0, 1, 0, 3},
        {4, 0, 4, 0, 2, 0, 4, 0, 2, 0, 2, 0, 4, 0, 4},
        {1, 0, 3, 0, 1, 0, 3, 0, 1, 0, 1, 0, 3, 0, 1},
        {2, 0, 2, 0, 4, 0, 2, 0, 4, 0, 4, 0, 2, 0, 2},
        {3, 0, 1, 0, 3, 0, 1, 2, 3, 0, 3, 0, 1, 0, 3},
        {4, 0, 4, 0, 2, 0, 0, 0, 0, 0, 2, 0, 4, 0, 4},
        {1, 0, 3, 0, 1, 2, 3, 4, 1, 2, 3, 0, 3, 0, 1},
        {2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 2},
        {3, 4, 3, 2, 1, 4, 3, 2, 1, 4, 3, 2, 1, 4, 1},
    },
    {
        {4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
    }};


void main(void)
{
    fileptr = fopen("test.txt", "w");

    time_t t = time(NULL);
    char *time_s = ctime(&t);
    time_s[3] = '_';
    time_s[7] = '_';
    time_s[10] = '_';
    time_s[19] = '_';
    time_s[24] = '\0';

    int level = 2;
    int score = 3320;
    int lives = 3;

    fprintf(fileptr, "%s %d %d %d ", time_s, level, score, lives);

    for (int i=0; i<15; i++)
    {
        for (int j=0; j<15; j++)
        {
            fprintf(fileptr, "%d ", levelGrid[level-1][i][j]);
        }
    }
    fprintf(fileptr, "\n");

    fclose(fileptr);


    // Read
    fr = fopen("test.txt", "r");

    char newtime[26];
    int lvl=99, scr=99, lvs=99;
    int blockstate[15][15];
    for (int p=0; p<5; p++)
    {
        fscanf(fr, "%s", newtime);
        if (strlen(newtime))
        {    
            fscanf(fr, "%d %d %d", &lvl, &scr, &lvs);
            printf("Time: %s\nLevel: %d\nScore: %d\nLives: %d\n", newtime, lvl, scr, lvs);

            for (int i=0; i<15; i++)
            {
                for (int j=0; j<15; j++)
                {
                    fscanf(fr, "%d", &blockstate[i][j]);
                }
            }
            printf("Block State:\n");
            for (int i=0; i<15; i++)
            {
                for (int j=0; j<15; j++)
                {
                    printf("%d ", blockstate[i][j]);
                }
                printf("\n");
            }
        }
        strcpy(newtime, "");
    }
    fclose(fr);
}